import"./DsnmJJEf.js";import{p as Se,d as re,i as o,z as h,t as y,a as xe,a0 as T,a1 as oe,c as _,s as p,r as d,f as Ve}from"./BpRt2mh-.js";import{d as Te,a as f,s as le,e as W,r as We}from"./CSeQF5Ga.js";import{a as g,f as w}from"./CXy7eh0M.js";import{i as se}from"./D5Mqzety.js";import{e as ze,r as ne,s as ie,a as Ae}from"./6gtY402H.js";import{s as i}from"./CK5yDnZ6.js";import{i as Fe,s as Re}from"./C7eVFner.js";import{b as Ie}from"./CZx5pxKY.js";import{p as c}from"./DLcFoIAq.js";var Ne=w("<option> </option>"),Ze=w("<select></select>"),Me=w('<div><input type="url" placeholder="https://..."/> <button type="button" aria-label="Limpiar URL">✕</button></div>'),Oe=w('<input type="file" class="photo-file-input-hidden" accept="image/*"/> <div role="button" tabindex="0"><span class="photo-dropzone-title">Arrastra imagen aquí</span> <span class="photo-dropzone-subtitle">o toca para elegir archivo</span></div> <div><input type="text" readonly=""/> <button type="button" aria-label="Limpiar archivo">✕</button></div>',1),qe=w('<div class="photo-preview-wrap" aria-live="polite"><span class="label-caps">Preview</span> <img alt="Preview foto"/></div>'),je=w('<p class="photo-picker-error">No se pudo cargar el preview de la imagen.</p>'),Be=w('<section aria-label="Fuente de foto"><span class="label-caps"> </span> <div class="photo-content"><div class="photo-controls"><div class="photo-segment-controls" role="tablist" aria-label="Tipo de foto"><button type="button">Preset</button> <button type="button">URL</button> <button type="button">Archivo Local</button></div> <!></div> <!></div></section>');function at(ce,l){Se(l,!0);let ue=c(l,"title",3,""),M=c(l,"options",19,()=>[]),m=c(l,"source",3,"preset"),C=c(l,"presetValue",3,""),O=c(l,"urlValue",3,""),q=c(l,"localValue",3,""),s=c(l,"dense",3,!1),j=c(l,"serverUrl",3,""),z=c(l,"onSourceChange",3,()=>{}),ve=c(l,"onPresetChange",3,()=>{}),B=c(l,"onUrlChange",3,()=>{}),k=c(l,"onLocalChange",3,()=>{}),A=c(l,"onError",3,()=>{}),E=T(!1),L=T(!1),P=T(void 0),S=T("");function G(e){return e?e.startsWith("http://")||e.startsWith("https://")||e.startsWith("data:")||e.startsWith("blob:")?e:e.startsWith("/")?`${j()}${e}`:`${j()}/${e.replace(/^\/+/,"")}`:""}function pe(e){return new Promise((t,r)=>{const a=new FileReader;a.onload=()=>t(String(a.result||"")),a.onerror=()=>r(new Error("No se pudo leer el archivo")),a.readAsDataURL(e)})}async function H(e){if(!e){k()("");return}if(!e.type.startsWith("image/")){A()("El archivo debe ser una imagen."),k()("");return}try{const t=await pe(e);k()(t),A()(""),h(L,!1)}catch(t){console.error("Error reading local photo",t),A()("No se pudo procesar la imagen local."),k()("")}}async function de(e){const t=e.currentTarget.files?.[0];await H(t)}function J(){o(P)?.click()}function fe(e){e.preventDefault(),h(E,!0)}function he(e){e.preventDefault(),h(E,!1)}async function _e(e){e.preventDefault(),h(E,!1);const t=e.dataTransfer?.files?.[0];await H(t)}function be(){B()("")}function me(){k()(""),o(P)&&(o(P).value="")}const ge=oe(()=>m()==="local"?q():m()==="url"?O().trim():C()),x=oe(()=>G(o(ge)));re(()=>{o(x),h(L,!1)});function we(){h(L,!0)}re(()=>{const e=M().map(r=>r.value).filter(r=>typeof r=="string"&&r.trim().length>0);if(e.length===0){h(S,"");return}const t=Math.floor(Math.random()*e.length);h(S,e[t],!0)});var V=Be();let K;var F=_(V),ye=_(F,!0);d(F);var Q=p(F,2),R=_(Q),I=_(R),N=_(I);let X;var Z=p(N,2);let Y;var $=p(Z,2);let ee;d(I);var ke=p(I,2);{var Le=e=>{var t=Ze();let r;ze(t,21,M,n=>n.value,(n,v)=>{var u=Ne(),b=_(u,!0);d(u);var D={};y(()=>{le(b,o(v).label),D!==(D=o(v).value)&&(u.value=(u.__value=o(v).value)??"")}),g(n,u)}),d(t);var a;Fe(t),y(()=>{r=i(t,1,"photo-select",null,r,{dense:s()}),a!==(a=C())&&(t.value=(t.__value=C())??"",Re(t,C()))}),f("change",t,n=>ve()(n.currentTarget.value)),g(e,t)},Pe=e=>{var t=Me();let r;var a=_(t);ne(a);let n;var v=p(a,2);let u;d(t),y(()=>{r=i(t,1,"photo-input-row",null,r,{dense:s()}),ie(a,O()),n=i(a,1,"",null,n,{dense:s()}),u=i(v,1,"photo-clear-btn",null,u,{dense:s()})}),f("input",a,b=>B()(b.currentTarget.value)),f("click",v,be),g(e,t)},De=e=>{var t=Oe(),r=Ve(t);Ie(r,U=>h(P,U),()=>o(P));var a=p(r,2);let n;var v=p(a,2);let u;var b=_(v);ne(b);let D;var te=p(b,2);let ae;d(v),y(()=>{n=i(a,1,"photo-dropzone",null,n,{dense:s(),active:o(E)}),u=i(v,1,"photo-input-row",null,u,{dense:s()}),D=i(b,1,"photo-file-input",null,D,{dense:s()}),ie(b,q()?"Imagen local cargada ✅":"Sin archivo"),ae=i(te,1,"photo-clear-btn",null,ae,{dense:s()})}),f("change",r,de),W("dragover",a,fe),W("dragleave",a,he),W("drop",a,_e),f("click",a,J),f("keydown",a,U=>{(U.key==="Enter"||U.key===" ")&&(U.preventDefault(),J())}),f("click",te,me),g(e,t)};se(ke,e=>{m()==="preset"?e(Le):m()==="url"?e(Pe,1):e(De,!1)})}d(R);var Ue=p(R,2);{var Ce=e=>{var t=qe(),r=p(_(t),2);let a;d(t),y(n=>{Ae(r,"src",n),a=i(r,1,"photo-preview",null,a,{dense:s()})},[()=>o(x)||G(o(S))]),W("error",r,we),We(r),g(e,t)},Ee=e=>{var t=je();g(e,t)};se(Ue,e=>{(o(x)||o(S))&&!o(L)?e(Ce):o(x)&&o(L)&&e(Ee,1)})}d(Q),d(V),y(()=>{K=i(V,1,"photo-picker",null,K,{dense:s()}),le(ye,ue()),X=i(N,1,"photo-segment-btn",null,X,{dense:s(),active:m()==="preset"}),Y=i(Z,1,"photo-segment-btn",null,Y,{dense:s(),active:m()==="url"}),ee=i($,1,"photo-segment-btn",null,ee,{dense:s(),active:m()==="local"})}),f("click",N,()=>z()("preset")),f("click",Z,()=>z()("url")),f("click",$,()=>z()("local")),g(ce,V),xe()}Te(["click","change","input","keydown"]);export{at as P};
